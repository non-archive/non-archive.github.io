<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Server and User Info</title>

        <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    </head>
    <body class=" overflow-x-hidden">
        <div class="container">
            <!-- Left column: Server information -->
            <div class="column">
                <h2>§ Server Information</h2>

                <h3>• Location and Hosting</h3>
                <ul id="server-location"></ul>

                <h3>◦ Web Information</h3>
                <ul id="web-info"></ul>

                <h3>▫ Performance and Timing</h3>
                <ul id="performance-info"></ul>
            </div>

            <!-- Right column: User information -->
            <div class="column">
                <h2>¤ User Information</h2>

                <h3>○ Location and Connection</h3>
                <ul id="user-location"></ul>
            </div>
        </div>

                <div id="playground" class="absolute inset-0 z-30 pointer-events-none overflow-hidden">
            <div class="agent absolute h-40 aspect-square cursor-pointer z-30" style="top: 0; left: 0">
                <model-viewer
                    class="mb-2 w-full h-full pointer-events-none"
                    src="/project/characters/controler.glb"
                    tone-mapping="neutral"
                    shadow-intensity="2"
                    shadow-softness="0"
                    exposure="1.15"
                    camera-orbit="99.92deg 0deg 3.792m"
                    field-of-view="30deg"
                    auto-rotate
                >
                </model-viewer>
                <div class="absolute top-4 left-4 text-xl  pointer-events-auto">
                    <h3 class="text-3xl mb-2 hidden agent-text">Linear Character</h3>
                    <p class="mb-6 hidden agent-text">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Culpa sit recusandae voluptas velit placeat maxime reprehenderit aliquam odio
                        adipisci, ut laudantium autem obcaecati explicabo iusto rerum illum error possimus aperiam!
                    </p>
                    <a href="/linear" class="bg-white p-2 border hover:bg-blue-200 hidden agent-text">Access</a>
                </div>
            </div>

            <div class="agent absolute h-40 aspect-square cursor-pointer z-30" style="top: 0; left: 0">
                <model-viewer
                    class="mb-2 w-full h-full pointer-events-none"
                    src="/project/characters/hashtag.glb"
                    tone-mapping="neutral"
                    shadow-intensity="2"
                    shadow-softness="0"
                    exposure="1.15"
                    camera-orbit="99.92deg 0deg 3.792m"
                    field-of-view="30deg"
                    auto-rotate
                >
                </model-viewer>
                <div class="absolute top-4 left-4 text-xl  pointer-events-auto">
                    <h3 class="text-3xl mb-2 hidden agent-text">Files Character</h3>
                    <p class="mb-6 hidden agent-text">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Culpa sit recusandae voluptas velit placeat maxime reprehenderit aliquam odio
                        adipisci, ut laudantium autem obcaecati explicabo iusto rerum illum error possimus aperiam!
                    </p>
                    <a href="/files" class="bg-white p-2 border hover:bg-blue-200 hidden agent-text">Access</a>
                </div>
            </div>

            <div class="agent absolute h-40 aspect-square cursor-pointer z-30" style="top: 0; left: 0">
                <model-viewer
                    class="mb-2 w-full h-full pointer-events-none"
                    src="/project/characters/controler.glb"
                    tone-mapping="neutral"
                    shadow-intensity="2"
                    shadow-softness="0"
                    exposure="1.15"
                    camera-orbit="99.92deg 0deg 3.792m"
                    field-of-view="30deg"
                    auto-rotate
                >
                </model-viewer>
                <div class="absolute top-4 left-4 text-xl  pointer-events-auto">
                    <h3 class="text-3xl mb-2 hidden agent-text">Infrastructure Character</h3>
                    <p class="mb-6 hidden agent-text">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Culpa sit recusandae voluptas velit placeat maxime reprehenderit aliquam odio
                        adipisci, ut laudantium autem obcaecati explicabo iusto rerum illum error possimus aperiam!
                    </p>
                    <a href="/infrastructure" class="bg-white p-2 border hover:bg-blue-200 hidden agent-text">Access</a>
                </div>
            </div>

            <div class="agent absolute h-40 aspect-square cursor-pointer z-30" style="top: 0; left: 0">
                <model-viewer
                    class="mb-2 w-full h-full pointer-events-none"
                    src="/project/characters/hashtag.glb"
                    tone-mapping="neutral"
                    shadow-intensity="2"
                    shadow-softness="0"
                    exposure="1.15"
                    camera-orbit="99.92deg 0deg 3.792m"
                    field-of-view="30deg"
                    auto-rotate
                >
                </model-viewer>
                <div class="absolute top-4 left-4 text-xl  pointer-events-auto">
                    <h3 class="text-3xl mb-2 hidden agent-text">Spatial</h3>
                    <p class="mb-6 hidden agent-text">
                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Culpa sit recusandae voluptas velit placeat maxime reprehenderit aliquam odio
                        adipisci, ut laudantium autem obcaecati explicabo iusto rerum illum error possimus aperiam!
                    </p>
                    <a href="#" class="bg-white p-2 border hover:bg-blue-200 hidden agent-text">Access</a>
                </div>
            </div>
        </div>

        <!-- Overlay para cerrar al hacer clic fuera -->
        <div id="overlay" class="fixed inset-0 backdrop-blur-lg bg-opacity-50 z-20 hidden"></div>

        <!-- Cargamos el script externo -->
        <script src="/linear/index_files/moving.js"></script>
        <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>

        <script>
            // Function to create list items
            function createListItem(label, value) {
                return `<li><strong>${label}:</strong> ${value}</li>`;
            }

            // Load all information when page loads
            window.addEventListener("load", async () => {
                // Server location information
                let serverLocationHTML = "";
                const hostname = window.location.hostname;

                try {
                    // First get server IP using DNS lookup API
                    const dnsResponse = await fetch(`https://dns.google/resolve?name=${hostname}&type=A`);
                    const dnsData = await dnsResponse.json();
                    const serverIP = dnsData.Answer ? dnsData.Answer[0].data : "Not resolved";

                    serverLocationHTML += createListItem("Server Hostname", hostname);
                    serverLocationHTML += createListItem("Server IP", serverIP);

                    // If we got an IP, get geolocation info for the server
                    if (serverIP !== "Not resolved") {
                        try {
                            const locationResponse = await fetch(`https://ipapi.co/${serverIP}/json/`);
                            const locationData = await locationResponse.json();

                            serverLocationHTML += createListItem("Server City", locationData.city || "Not available");
                            serverLocationHTML += createListItem("Server Country", locationData.country_name || "Not available");
                            serverLocationHTML += createListItem("Server Region", locationData.region || "Not available");
                            serverLocationHTML += createListItem("Server ISP/Hosting", locationData.org || "Not available");
                            serverLocationHTML += createListItem("Server Timezone", locationData.timezone || "Not available");
                        } catch (error) {
                            serverLocationHTML += createListItem("Server Location", "Error fetching location data");
                        }
                    }
                } catch (error) {
                    serverLocationHTML += createListItem("Server Hostname", hostname);
                    serverLocationHTML += createListItem("Server IP", "Error resolving");
                    serverLocationHTML += createListItem("Server Info", "DNS lookup failed");
                }

                document.getElementById("server-location").innerHTML = serverLocationHTML;

                // Web information
                const webInfoHTML = `
                ${createListItem("Current URL", window.location.href)}
                ${createListItem("Protocol", window.location.protocol)}
                ${createListItem("Host", window.location.host)}
                ${createListItem("Port", window.location.port || "Default")}
                ${createListItem("Domain", window.location.hostname)}
            `;
                document.getElementById("web-info").innerHTML = webInfoHTML;

                // Performance and timing
                let performanceHTML = "";
                if (performance && performance.timing) {
                    const timing = performance.timing;
                    const loadTime = timing.loadEventEnd - timing.navigationStart;
                    const domTime = timing.domContentLoadedEventEnd - timing.navigationStart;

                    performanceHTML += createListItem("Total Load Time", `${loadTime}ms`);
                    performanceHTML += createListItem("DOM Ready Time", `${domTime}ms`);
                    performanceHTML += createListItem("Navigation Type", performance.navigation.type);
                    performanceHTML += createListItem("Redirects", performance.navigation.redirectCount);
                }

                if (performance && performance.memory) {
                    performanceHTML += createListItem("JS Memory Used", `${Math.round(performance.memory.usedJSHeapSize / 1024 / 1024)}MB`);
                    performanceHTML += createListItem("JS Memory Limit", `${Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)}MB`);
                }

                performanceHTML += createListItem("Effective Connection", navigator.connection?.effectiveType || "Not available");
                performanceHTML += createListItem("Connection Type", navigator.connection?.type || "Not available");

                document.getElementById("performance-info").innerHTML = performanceHTML;

                // User location
                let userLocationHTML = "";
                try {
                    const response = await fetch("https://ipapi.co/json/");
                    const data = await response.json();
                    userLocationHTML = `
                    ${createListItem("Public IP", data.ip || "Not available")}
                    ${createListItem("City", data.city || "Not available")}
                    ${createListItem("Region", data.region || "Not available")}
                    ${createListItem("Country", data.country_name || "Not available")}
                    ${createListItem("Country Code", data.country_code || "Not available")}
                    ${createListItem("Timezone", data.timezone || "Not available")}
                    ${createListItem("ISP", data.org || "Not available")}
                    ${createListItem("Coordinates", data.latitude && data.longitude ? `${data.latitude}, ${data.longitude}` : "Not available")}
                    ${createListItem("Postal Code", data.postal || "Not available")}
                    ${createListItem("Currency", data.currency || "Not available")}
                `;
                } catch (error) {
                    userLocationHTML = createListItem("User IP", "Error fetching");
                }
                document.getElementById("user-location").innerHTML = userLocationHTML;
            });
        </script>

    </body>
</html>
