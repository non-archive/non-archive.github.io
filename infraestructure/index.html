<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server and User Info</title>
    <style>
        body {
            margin: 0;
        }
        .container {
            font-family: monospace;
            margin: 20px;
            display: flex;
            gap: 40px;
        }
        .column {
            flex: 1;
        }

        h3{
            margin: 0;
        }

        a {
            color: blue
        }

        a:hover{
            background-color: red;
        }
        header {
            background-color: rgb(145, 145, 145);
            color: black;
            padding: 0px 3px;

        }
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h3>Change character: <a href="/linear">linear-character</a> / <a href="/files">files-character</a> / <a href="/infraestructure">infraestructure-character</a></h3>
    </header>
    <div class="container">
        <div class="column">
            <h2>§ Server Information</h2>
            
            <h3>• Location and Hosting</h3>
            <ul id="server-location"></ul>

            <h3>◦ Web Information</h3>
            <ul id="web-info"></ul>

            <h3>▫ Performance and Timing</h3>
            <ul id="performance-info"></ul>
        </div>

        <div class="column">
            <h2>¤ Your Information</h2>
            
            <h3>○ Location and Connection</h3>
            <ul id="user-location"></ul>
        </div>

        <div class="column">
        </div>
    </div>

    <script>
        // Function to create list items
        function createListItem(label, value) {
            return `<li><strong>${label}:</strong> ${value}</li>`;
        }

        // Load all information when page loads
        window.addEventListener('load', async () => {
            // Server location information
            let serverLocationHTML = '';
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                serverLocationHTML += createListItem('Server IP', data.ip || 'Not available');
                serverLocationHTML += createListItem('City', data.city || 'Not available');
                serverLocationHTML += createListItem('Country', data.country_name || 'Not available');
                serverLocationHTML += createListItem('ISP', data.org || 'Not available');
            } catch (error) {
                serverLocationHTML += createListItem('Server IP', 'Error fetching');
            }
            document.getElementById('server-location').innerHTML = serverLocationHTML;

            // Web information
            const webInfoHTML = `
                ${createListItem('Current URL', window.location.href)}
                ${createListItem('Protocol', window.location.protocol)}
                ${createListItem('Host', window.location.host)}
                ${createListItem('Port', window.location.port || 'Default')}
                ${createListItem('Domain', window.location.hostname)}
            `;
            document.getElementById('web-info').innerHTML = webInfoHTML;

            // Performance and timing
            let performanceHTML = '';
            if (performance && performance.timing) {
                const timing = performance.timing;
                const loadTime = timing.loadEventEnd - timing.navigationStart;
                const domTime = timing.domContentLoadedEventEnd - timing.navigationStart;
                
                performanceHTML += createListItem('Total Load Time', `${loadTime}ms`);
                performanceHTML += createListItem('DOM Ready Time', `${domTime}ms`);
                performanceHTML += createListItem('Navigation Type', performance.navigation.type);
                performanceHTML += createListItem('Redirects', performance.navigation.redirectCount);
            }

            if (performance && performance.memory) {
                performanceHTML += createListItem('JS Memory Used', `${Math.round(performance.memory.usedJSHeapSize / 1024 / 1024)}MB`);
                performanceHTML += createListItem('JS Memory Limit', `${Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)}MB`);
            }

            performanceHTML += createListItem('Effective Connection', navigator.connection?.effectiveType || 'Not available');
            performanceHTML += createListItem('Connection Type', navigator.connection?.type || 'Not available');
            
            document.getElementById('performance-info').innerHTML = performanceHTML;

            // User location
            let userLocationHTML = '';
            try {
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                userLocationHTML = `
                    ${createListItem('Public IP', data.ip || 'Not available')}
                    ${createListItem('City', data.city || 'Not available')}
                    ${createListItem('Region', data.region || 'Not available')}
                    ${createListItem('Country', data.country_name || 'Not available')}
                    ${createListItem('Country Code', data.country_code || 'Not available')}
                    ${createListItem('Timezone', data.timezone || 'Not available')}
                    ${createListItem('ISP', data.org || 'Not available')}
                    ${createListItem('Coordinates', data.latitude && data.longitude ? `${data.latitude}, ${data.longitude}` : 'Not available')}
                    ${createListItem('Postal Code', data.postal || 'Not available')}
                    ${createListItem('Currency', data.currency || 'Not available')}
                `;
            } catch (error) {
                userLocationHTML = createListItem('User IP', 'Error fetching');
            }
            document.getElementById('user-location').innerHTML = userLocationHTML;
        });
    </script>
</body>
</html>